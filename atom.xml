<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[iceout's blog]]></title>
  <link href="http://iceout.github.com/atom.xml" rel="self"/>
  <link href="http://iceout.github.com/"/>
  <updated>2012-08-24T10:28:23+08:00</updated>
  <id>http://iceout.github.com/</id>
  <author>
    <name><![CDATA[iceout]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Expert C Programming 笔记]]></title>
    <link href="http://iceout.github.com/blog/2012/08/03/expert-c-programming-note/"/>
    <updated>2012-08-03T13:48:00+08:00</updated>
    <id>http://iceout.github.com/blog/2012/08/03/expert-c-programming-note</id>
    <content type="html"><![CDATA[<h2 id="chapter-2">Chapter 2:</h2>
<p>分析编程语言的缺陷的一种方法是把缺陷分为三类:多做之过，少作之过和误做之过。</p>

<h3 id="section">1. 多做之过</h3>
<ol>
  <li>switch的case不加break就会一次执行下去。</li>
  <li>const修饰的变量并不是真正的常量，表现之一是无法在swith里当作case使用。</li>
  <li>相邻的字符串常量自动合并为一个字符串。</li>
  <li>太多的全局可见性。</li>
</ol>

<!-- more -->

<h3 id="section-1">2. 误做之过</h3>
<ol>
  <li>
    <p>许多符号（甚至是关键字）在不同的上下文环境中有不同的意义。</p>

    <blockquote>
      <p><code>static</code></p>

      <pre><code>    修饰函数，表示该函数只对本文件可见
    在函数内部，表示该变量在各个调用间一直保持延续性
</code></pre>

      <p><code>extern</code></p>

      <pre><code>    用于变量，不是它在其他地方定义
    用于函数定义，表示全局可见（属于冗余的）
</code></pre>

      <p><code>void</code></p>

      <pre><code>    作为函数的返回类型，表示不返回任何值
    在指针声明中，表示通用指针类型
    位于参数列表中，表示没有参数
</code></pre>

      <p><code>()</code></p>

      <pre><code>    在函数定义中，包围形式参数
    调用一个函数
    改变表达式的运算次序
    强制类型转换
    定义带参数的宏
    包围sizeof操作符的操作数（如果它是类型名）
</code></pre>
    </blockquote>
  </li>
  <li>
    <p>运算符优先级</p>
  </li>
</ol>

<p><img src="http://iceout.github.com/uploads/PrecedenceofC.png" alt="Precedence of c operator" /></p>

<h3 id="section-2">3. 少做之过</h3>
<ol>
  <li>参数的解析</li>
  <li>注释</li>
  <li>自动变量的内存分配</li>
</ol>

<h2 id="chapter-3">Chapter 3:</h2>
<p>C语言的声明</p>

<p>如果const和/或volatile关键字的后面紧跟类型说明符,那么它作用于类型说明符.其他情况下const和/或volatile关键字作用于它左边紧邻的指针星号.</p>

<ol>
  <li>找到最左边的标识符,表示”标识符是”</li>
  <li>查看右边的下一个字符,
    <ol>
      <li>如果是’[‘,到’]‘为止,表示”…的数组”</li>
      <li>如果是’(‘,到’)’为止,表示”返回…的函数”</li>
    </ol>
  </li>
  <li>标识符左边的符号是’(‘,它与对应的’)’之间的内容为我们已经处理的表达式.跳转到第二步.</li>
  <li>如果左边的符号为const,volatile或*,继续向左读取符号,直到所读取的符号不是那三个之一.然后跳转到第三步.
    <ol>
      <li>const表示”read-only”</li>
      <li>volatile表示”volatile”</li>
      <li>*表示”指向…的指针”</li>
    </ol>
  </li>
  <li>剩下的符号为基本类型.</li>
</ol>

<h2 id="chapter-4">Chapter 4:</h2>
<p>数组和指针</p>

<p>左值:’l-value’(for ‘left-hand-side’ or ‘locator’ value),表示地址,编译器会分配每个变量一个地址,即左值.
右值:’r-value’(for ‘right-hand-side’),表示the value stored in a variable,运行时变量的右值才知道.</p>

<p>‘modifiable l-value’:可修改的左值.数组名为左值但不可修改,不能出现在赋值符左边.</p>

<pre><code>Differences Between Arrays and Pointers
Pointer                                 Array

Holds the address of data               Holds data

Data is accessed indirectly,            Data is accessed directly, 
so you first retrieve the               so for a[i] you simply retrieve
contents of the pointer, load           the contents of the
that as an address (call it "L"),       location i units past a.
then retrieve its contents.
If the pointer has a subscript 
[i] you instead retrieve the 
contents of the location 'i' 
units past "L"

Commonly used for dynamic data          Commonly used for holding a 
structures                              fixed number of elements of the
                                        same type of data

Commonly used with malloc(), free()     Implicitly allocated and 
                                        deallocated

Typically points to anonymous data      Is a named variable in its own  
                                        right
</code></pre>

<p>定义指针时编译器并不为指针所指的对象分配空间,只是分配指针本身的空间,除非在定义指针时赋给指针一个字符串常量进行初始化,只有是字符串常量时才如此.</p>

<h2 id="chapter-5">Chapter 5:</h2>
<p>linking</p>

<p>书中这一章不是以gcc为例子,所以没有实验,只是粗略的看了一下.</p>

<h2 id="chapter-6">Chapter 6:</h2>
<p>运行时数据结构</p>

<p>linux下可执行文件的第一个字节依然是7F,第二至四字节依然是ELF.</p>

<p>使用size可以查看可执行文件的各个section大小.</p>

<p>data段存储初始过的全局和静态变量,bss段保存没有值的变量,text段保存可执行命令(声明变量不算命令,声明变量并初始化算命令…).</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
</pre></td><td class="code"><pre><code class="cpp"><span class="line"><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class="line"><span class="cm">/*int num[1000]={2,45};*/</span>
</span><span class="line"><span class="cm">/*int num[1000]={2,45};*/</span>
</span><span class="line"><span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">argv</span><span class="p">[])</span>
</span><span class="line"><span class="p">{</span>
</span><span class="line">    <span class="cm">/*int mm[1000]={98,12};*/</span>
</span><span class="line">    <span class="cm">/*int mm[1000];*/</span>
</span><span class="line">    <span class="cm">/*printf(&quot;%p\n&quot;, num);*/</span>
</span><span class="line">    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;hello</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class="line">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class=""><span class="line">text	   data	    bss	    dec	    hex	filename
</span><span class="line">1034	    288	      4	   1326	    52e	a.out</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
</pre></td><td class="code"><pre><code class="cpp"><span class="line">
</span><span class="line">    <span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class="line">
</span><span class="line">    <span class="kt">int</span> <span class="n">num</span><span class="p">[</span><span class="mi">1000</span><span class="p">];</span>
</span><span class="line">    <span class="cm">/*int num[1000]={2,45};*/</span>
</span><span class="line">    <span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">argv</span><span class="p">[])</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">        <span class="cm">/*int mm[1000]={98,12};*/</span>
</span><span class="line">        <span class="cm">/*int mm[1000];*/</span>
</span><span class="line">        <span class="cm">/*printf(&quot;%p\n&quot;, num);*/</span>
</span><span class="line">        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;hello</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class="line">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">    <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class=""><span class="line">text	   data	    bss	    dec	    hex	filename  
</span><span class="line">1034	    288	   4032	   5354	   14ea	a.out</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</pre></td><td class="code"><pre><code class="cpp"><span class="line">
</span><span class="line">    <span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class="line">
</span><span class="line">    <span class="kt">int</span> <span class="n">num</span><span class="p">[</span><span class="mi">1000</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">45</span><span class="p">};</span>
</span><span class="line">    <span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">argv</span><span class="p">[])</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">        <span class="cm">/*int mm[1000]={98,12};*/</span>
</span><span class="line">        <span class="cm">/*int mm[1000];*/</span>
</span><span class="line">        <span class="cm">/*printf(&quot;%p\n&quot;, num);*/</span>
</span><span class="line">        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;hello</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class="line">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">    <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class=""><span class="line">text	   data	    bss	    dec	    hex	filename  
</span><span class="line">1034	   4312	      4	   5350	   14e6	a.out</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
</pre></td><td class="code"><pre><code class="cpp"><span class="line">    <span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class="line">    <span class="kt">int</span> <span class="n">num</span><span class="p">[</span><span class="mi">1000</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">45</span><span class="p">};</span>
</span><span class="line">    <span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">argv</span><span class="p">[])</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">        <span class="cm">/*int mm[1000]={98,12};*/</span>
</span><span class="line">        <span class="kt">int</span> <span class="n">mm</span><span class="p">[</span><span class="mi">1000</span><span class="p">];</span>
</span><span class="line">        <span class="cm">/*printf(&quot;%p\n&quot;, num);*/</span>
</span><span class="line">        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;hello</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class="line">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">    <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class=""><span class="line">text    data    bss     dec	   hex    filename
</span><span class="line">1034    4312      4    5350   14e6	  a.out</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="cpp"><span class="line">    <span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class="line">    <span class="kt">int</span> <span class="n">num</span><span class="p">[</span><span class="mi">1000</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">45</span><span class="p">};</span>
</span><span class="line">    <span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">argv</span><span class="p">[])</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">        <span class="kt">int</span> <span class="n">mm</span><span class="p">[</span><span class="mi">1000</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">98</span><span class="p">,</span><span class="mi">12</span><span class="p">};</span>
</span><span class="line">        <span class="cm">/*printf(&quot;%p\n&quot;, num);*/</span>
</span><span class="line">        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;hello</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class="line">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">    <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class=""><span class="line">text	   data	    bss	    dec	    hex	filename  
</span><span class="line">1090	   4312	      4	   5406	   151e	a.out</span></code></pre></td></tr></table></div></figure></notextile></div>

<h3 id="section-3">可执行程序各个段在内存中的布局</h3>
<p><img src="http://iceout.github.com/uploads/segment_in_memory.png" alt="how the segments of an executable are laid out in memory" /></p>

<p>连接器将各个段映射到内存中时可以设置不同的属性,如read-and-execute-only,read-write-no-execute,read-only等.data段和BSS段通称数据区.注意,最底部的虚拟地址未被映射,它在进程的地址空间内,但是并没有赋予物理地址,所以不能引用.
另外程序还需要堆(heap),使用malloc()等动态分配内存.</p>

<p>栈主要有三个用途:
1. 函数内部的局部变量(c术语automatic variables).
2. 函数调用时候的维护信息.这些信息称作stack frame,或precedure activation recored.
3. 栈也是一个临时储存区域.使用alloca()获得的存储区域就在栈中.</p>

<p>stack frame的结构(回头可以参看一下csapp)
|——————|
| local variables  |
|——————|
|   arguments      |
|     ……       |
|     ……       |
|   arguments      |
|——————|
|   static link    |
|——————|
|     ptr to       |
|  previous frame  |
|——————|
|   return address |
|——————|</p>

<p>自动变量/局部变量在stack中分配,所以当函数结束时就不存在了.而static变量储存在数据段中,生命周期与程序一样长.</p>

<p>stack frame可能并不位于stack中.</p>

<p><code>setjmp(jmp_buf j)</code>:使用变量j记录现在的位置,返回0.
<code>longjmp(jmp_buf j, int i)</code>:回到j所记录的位置,好像是从<code>setjmp()</code>返回一样,返回值是i.</p>

<h2 id="chapter-7">Chapter 7:</h2>

<h3 id="x86">7.2 80x86内存模型</h3>

<p>8086内存地址形成的经过:取得段寄存器的值,左移4位,扩展为20位的,然后加上偏移地址,得到最终地址.</p>

<h3 id="section-4">7.5 数据段和堆</h3>

<table>
  <thead>
    <tr>
      <th>stack segment</th>
      <th>(data local to functions)</th>
    </tr>
    <tr>
      <th>……</th>
      <th> </th>
    </tr>
    <tr>
      <th>……</th>
      <th> </th>
    </tr>
    <tr>
      <th>……</th>
      <th> </th>
    </tr>
    <tr>
      <th>……</th>
      <th> </th>
    </tr>
    <tr>
      <th>——————</th>
      <th>— the break</th>
    </tr>
    <tr>
      <th>the heap</th>
      <th>(used for malloc())</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>BSS segment</td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>data segment</td>
      <td> </td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td>text segment</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p><code>calloc</code>和<code>malloc</code>的区别是<code>calloc</code>会把申请的内存清零.</p>

<p><code>malloc</code>所分配的内存比申请的内存大,因为需要额外的空间记录管理信息(参见APUE7.8章),而且一般<code>malloc</code>采用的是__simple power of two free list__内存管理机制,获得的内存大小是<script type="math/tex">2^n</script>.</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="cpp"><span class="line">    <span class="n">malloc</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">:</span> <span class="n">size</span> <span class="o">=</span> <span class="n">roundup</span><span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">header</span><span class="p">))</span>
</span><span class="line">    <span class="n">roundup</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="n">n</span><span class="p">,</span> <span class="n">where</span> <span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Y</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="o">^</span><span class="n">n</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>堆的末端由一个被称为break的指针标识,当需要更多内存时,可以调用brk和sbrk移动break指针.
###7.6 内存泄漏</p>

<p>如何检查内存泄漏:
1. 先看看有多少交换空间</p>

<pre><code>cat /proc/swaps
free
</code></pre>

<ol>
  <li>
    <p>查看某个进程的内存</p>

    <p>ps -lu username</p>
  </li>
</ol>

<h3 id="section-5">7.7</h3>
<p>如何在一个链表中释放元素:用一个临时变量储存下一个元素的地址.</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="cpp"><span class="line">    <span class="k">struct</span> <span class="n">node</span> <span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="o">*</span><span class="n">start</span><span class="p">,</span> <span class="o">*</span><span class="n">tmp</span><span class="p">;</span>
</span><span class="line">    <span class="k">for</span> <span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">start</span><span class="p">;</span> <span class="n">p</span><span class="p">;</span> <span class="n">p</span><span class="o">=</span><span class="n">tmp</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="n">tmp</span> <span class="o">=</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
</span><span class="line">        <span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
</span><span class="line">    <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>信号处理:</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
</pre></td><td class="code"><pre><code class="cpp"><span class="line">    <span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class="line">    <span class="cp">#include &lt;signal.h&gt;</span>
</span><span class="line">    <span class="cp">#include &lt;setjmp.h&gt;</span>
</span><span class="line">
</span><span class="line">    <span class="n">jmp_buf</span> <span class="n">buf</span><span class="p">;</span>
</span><span class="line">
</span><span class="line">    <span class="kt">void</span> <span class="n">handler</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">)</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">        <span class="k">if</span> <span class="p">(</span><span class="n">s</span> <span class="o">==</span> <span class="n">SIGSEGV</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="n">printf</span><span class="p">(</span><span class="s">&quot; segmentation violation signal</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">        <span class="k">if</span> <span class="p">(</span><span class="n">s</span> <span class="o">==</span> <span class="n">SIGILL</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="n">printf</span><span class="p">(</span><span class="s">&quot; now illegal instruction signal</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">        <span class="k">if</span> <span class="p">(</span><span class="n">s</span> <span class="o">==</span> <span class="n">SIGINT</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="n">printf</span><span class="p">(</span><span class="s">&quot; now SIGINT signal</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class="line">            <span class="n">longjmp</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">
</span><span class="line">    <span class="p">}</span>
</span><span class="line">
</span><span class="line">    <span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">argv</span><span class="p">[])</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">        <span class="cm">/*signal(SIGSEGV, handler);*/</span>
</span><span class="line">        <span class="cm">/*signal(SIGILL, handler);*/</span>
</span><span class="line">        <span class="n">signal</span><span class="p">(</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">handler</span><span class="p">);</span>
</span><span class="line">        <span class="k">if</span><span class="p">(</span><span class="n">setjmp</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span> <span class="p">{</span>
</span><span class="line">            <span class="n">printf</span><span class="p">(</span><span class="s">&quot;back in main</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class="line">            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">        <span class="k">else</span> <span class="p">{</span>
</span><span class="line">            <span class="n">printf</span><span class="p">(</span><span class="s">&quot;first time</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">        <span class="k">while</span><span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">);</span>
</span><span class="line">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">    <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="chapter-8">Chapter 8</h2>

<h3 id="making-a-glyph-from-bit-patterns">Making a Glyph from Bit Patterns</h3>

<p>一个很形象的方法,还可以当作秒表.</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
</pre></td><td class="code"><pre><code class="cpp"><span class="line">    <span class="cp">#define X )*2+1</span>
</span><span class="line">    <span class="cp">#define _ )*2</span>
</span><span class="line">    <span class="cp">#define s ((((((((((((((((0 </span><span class="cm">/* For building glyphs 16 bits</span>
</span><span class="line"><span class="cm">    wide */</span><span class="cp"></span>
</span><span class="line">    <span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">stopwatch</span><span class="p">[]</span> <span class="o">=</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">    <span class="n">s</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="p">,</span>
</span><span class="line">    <span class="n">s</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="p">,</span>
</span><span class="line">    <span class="n">s</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="p">,</span>
</span><span class="line">    <span class="n">s</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="p">,</span>
</span><span class="line">    <span class="n">s</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="p">,</span>
</span><span class="line">    <span class="n">s</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="p">,</span>
</span><span class="line">    <span class="n">s</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="p">,</span>
</span><span class="line">    <span class="n">s</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="p">,</span>
</span><span class="line">    <span class="n">s</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="p">,</span>
</span><span class="line">    <span class="n">s</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="p">,</span>
</span><span class="line">    <span class="n">s</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="p">,</span>
</span><span class="line">    <span class="n">s</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="p">,</span>
</span><span class="line">    <span class="n">s</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="p">,</span>
</span><span class="line">    <span class="n">s</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="p">,</span>
</span><span class="line">    <span class="n">s</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="p">,</span>
</span><span class="line">    <span class="n">s</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="p">,</span>
</span><span class="line">    <span class="p">};</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h3 id="section-6">8.3 类型提升</h3>
<p>类型提升就是在表达式中将变量类型按照规则提升为其他类型.
<code>printf("%d", sizeof 'a')</code>的结果为4,而不是1.</p>

<p>ANSI C:当编译器能保证不提升也能得到相同的结果时,可以不提升.</p>

<pre><code>        Type Promotions in C    
Original Type                   Usually Promoted To
char                            int
bit-field                       int
enum                            int
unsigned char                   int
short                           int
unsigned short                  int
float                           double
array of anything               pointer to anything
</code></pre>

<h3 id="section-7">8.4 函数原型</h3>

<p>函数参数也属于表达式,默认也会类型提升.
如果使用了函数原型,缺省参数提升就不会发生.</p>

<h3 id="section-8">8.6 不按回车获得字符</h3>

<p>这里只列出一个方案,其他的可以参考[这里][http://stackoverflow.com/questions/421860/c-c-capture-characters-from-standard-input-without-waiting-for-enter-to-be-pr].</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
</pre></td><td class="code"><pre><code class="cpp"><span class="line">
</span><span class="line">    <span class="cp">#include &lt;stdlib.h&gt;</span>
</span><span class="line">    <span class="cp">#include &lt;sys/ioctl.h&gt;</span>
</span><span class="line">    <span class="cp">#include &lt;curses.h&gt;</span>
</span><span class="line">
</span><span class="line">    <span class="kt">int</span> <span class="n">kbhit</span><span class="p">()</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">        <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
</span><span class="line">        <span class="n">ioctl</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">FIONREAD</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">i</span><span class="p">);</span>
</span><span class="line">        <span class="k">return</span> <span class="n">i</span><span class="p">;</span> <span class="cm">/* return a count of chars available to read */</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">    <span class="cm">/* uses curses library, and the kbhit() function defined above</span>
</span><span class="line"><span class="cm">    */</span>
</span><span class="line">    <span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">        <span class="kt">int</span> <span class="n">c</span><span class="o">=</span><span class="sc">&#39; &#39;</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span><span class="line">        <span class="n">initscr</span><span class="p">();</span> <span class="cm">/* initialize curses functions */</span>
</span><span class="line">        <span class="n">cbreak</span><span class="p">();</span>
</span><span class="line">        <span class="n">noecho</span><span class="p">();</span> <span class="cm">/* do not echo pressed character */</span>
</span><span class="line">        <span class="n">mvprintw</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Press &#39;q&#39; to quit</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class="line">        <span class="n">refresh</span><span class="p">();</span>
</span><span class="line">        <span class="k">while</span> <span class="p">(</span><span class="n">c</span><span class="o">!=</span><span class="sc">&#39;q&#39;</span><span class="p">)</span>
</span><span class="line">            <span class="k">if</span> <span class="p">(</span><span class="n">kbhit</span><span class="p">())</span> <span class="p">{</span>
</span><span class="line">                <span class="n">c</span> <span class="o">=</span> <span class="n">getch</span><span class="p">();</span> <span class="cm">/* won&#39;t block, as we know a character is</span>
</span><span class="line"><span class="cm">                                waiting */</span>
</span><span class="line">                <span class="n">mvprintw</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;got char &#39;%c&#39; on iteration %d </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">c</span><span class="p">,</span> <span class="o">++</span><span class="n">i</span><span class="p">);</span>
</span><span class="line">                <span class="n">refresh</span><span class="p">();</span>
</span><span class="line">            <span class="p">}</span>
</span><span class="line">        <span class="n">nocbreak</span><span class="p">();</span>
</span><span class="line">        <span class="n">echo</span><span class="p">();</span>
</span><span class="line">        <span class="n">endwin</span><span class="p">();</span> <span class="cm">/* finish curses */</span>
</span><span class="line">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">    <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h3 id="section-9">8.7</h3>

<p>函数指针数组:</p>

<pre><code>extern int a(), b();
int (*state[])() = {a, b};
state[0]();
(*state[1])();
</code></pre>

<h3 id="section-10">8.9 强制类型转换</h3>

<p>强制类型转换(cast)有两个作用,”类型转换”和”消除类型歧义”.</p>

<h2 id="chapter-9">Chapter 9</h2>

<p><img src="http://iceout.github.com/uploads/array_pointer.png" alt="Array" /></p>

<p>什么时候数组和指针是相同的:</p>

<ol>
  <li>表达式中数组名(与声明不同)被当做一个指向该数组第一个元素的指针.</li>
  <li>下标总是与指针的偏移量相同.</li>
  <li>在函数参数的声明中,数组名被编译器当做指向该数组第一个元素的指针.</li>
</ol>

<p>对数组的引用,如<code>a[i]</code>在编译时总是被编译器处理成<code>*(a+i)</code>的形式.<code>a[6]</code>和<code>6[a]</code>都是正确的.</p>

<p>总结:</p>

<p>Caution: don’t read this unless you’ve read and understood the preceding chapter, or it may cause
permanent brain-fade.
1. An array access <code>a[i]</code> is always “rewritten” or interpreted by the compiler as a pointer access <code>*(a+i)</code>;
2. Pointers are always just pointers; they are never rewritten to arrays. You can apply a subscript to a pointer; you typically do this when the pointer is a function argument, and you know that you will be passing an array in.
3. An array declaration in the specific context (only) of a function parameter can equally be written as a pointer. An array that is a function argument (i.e., in a call to the function) is always changed, by the compiler, to a pointer to the start of the array.
4. Therefore, you have the choice for defining a function parameter which is an array, either as an array or as a pointer. Whichever way you define it, you actually get a pointer inside the function.
5. In all other cases, definitions should match declarations. If you defined it as an array, your extern declaration should be an array. And likewise for a pointer.</p>

<h3 id="section-11">9.6 多维数组</h3>

<p>C语言的多维数组其实是数组的数组.<code>pea[i][j]</code>被编译器解析为<code>*(*(pea+i)+j)</code>.</p>

<p>初始化多维数组时,可以在最后一个初始化值后面加一个逗号,也可以省略.同时也可以省略最左边下标的长度(也只能时最左边的下标).</p>

<h4 id="section-12">分解多维数组</h4>

<pre><code>int apricot[2][3][4];
/*兼容类型*/
int (*p)[3][4] = apricot;
int (*r)[5] = apricot[i];
int *t = apricot[i][j];
int u = apricot[i][j][k];
</code></pre>

<h2 id="chapter-10">Chapter 10</h2>

<h3 id="section-13">10.2</h3>

<p>指针数组(<code>char *p[4]</code>)被称作Iliffe向量.</p>

<p>函数参数中”数组名被改写为一个指针参数”规则并不是递归定义的.数组的数组会被改写为”数组的指针”,而不是”指针的指针”.</p>

<pre><code>        实参                         形参
数组的数组 char c[9][9];        char(*)[10]; 数组指针
指针数组   char *c[9];          char **c;    指针的指针
数组指针   char (*c)[9];        char(*c)[9]; 不改变
指针的指针 char **c;            char **c;    不改变
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[使用python压缩文件夹]]></title>
    <link href="http://iceout.github.com/blog/2012/08/01/shi-yong-pythonya-suo-wen-jian-jia/"/>
    <updated>2012-08-01T17:23:00+08:00</updated>
    <id>http://iceout.github.com/blog/2012/08/01/shi-yong-pythonya-suo-wen-jian-jia</id>
    <content type="html"><![CDATA[<p>今天在stackoverflow回答了一个用python压缩文件时处理空文件夹的问题，直接粘贴了一段以前找的代码作为答案，竟然获得了一个铜牌，实在是有点羞愧。</p>

<p>不过那段代码压缩文件时是用的绝对路径,不太方便，为了安慰一下自己的心灵，现在改为相对路径，代码如下：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">zipfile</span>
</span><span class="line"><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span>
</span><span class="line"><span class="k">def</span> <span class="nf">zipfolder</span><span class="p">(</span><span class="n">foldername</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">includeEmptyDIr</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
</span><span class="line">    <span class="n">empty_dirs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class="line">    <span class="nb">zip</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">,</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZIP_DEFLATED</span><span class="p">)</span>
</span><span class="line">    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">foldername</span><span class="p">):</span>
</span><span class="line">        <span class="n">rel_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">foldername</span><span class="p">))</span>
</span><span class="line">        <span class="n">empty_dirs</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">dir</span> <span class="k">for</span> <span class="nb">dir</span> <span class="ow">in</span> <span class="n">dirs</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nb">dir</span><span class="p">))</span> <span class="o">==</span> <span class="p">[]])</span>
</span><span class="line">        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
</span><span class="line">            <span class="nb">zip</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="n">join</span><span class="p">(</span><span class="n">rel_path</span><span class="p">,</span><span class="n">name</span><span class="p">))</span>
</span><span class="line">        <span class="k">if</span> <span class="n">includeEmptyDIr</span><span class="p">:</span>
</span><span class="line">            <span class="k">for</span> <span class="nb">dir</span> <span class="ow">in</span> <span class="n">empty_dirs</span><span class="p">:</span>
</span><span class="line">                <span class="n">zif</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipInfo</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">rel_path</span><span class="p">,</span><span class="nb">dir</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span><span class="p">)</span>
</span><span class="line">                <span class="nb">zip</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="n">zif</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class="line">        <span class="n">empty_dirs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class="line">    <span class="nb">zip</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Chapter 12 二叉查找树]]></title>
    <link href="http://iceout.github.com/blog/2012/07/13/chapter-12-er-cha-cha-zhao-shu/"/>
    <updated>2012-07-13T14:41:00+08:00</updated>
    <id>http://iceout.github.com/blog/2012/07/13/chapter-12-er-cha-cha-zhao-shu</id>
    <content type="html"><![CDATA[<h2 id="section">1. 二叉查找树</h2>
<p>二叉查找树的性质 ：一个节点的key值大于等于它所有左子树节点的值，小于等于它所有右子树节点的值。 </p>

<p>中序遍历(inorder-tree-walk)的时间为<script type="math/tex">\Theta(n)</script>.</p>

<p>12.1-3 非递归 不用栈 中序遍历</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
</pre></td><td class="code"><pre><code class="c++"><span class="line"><span class="cm">/* 通过将节点的左子树中最右边节点的右孩子的指向（即q-&gt;right = p;）实现回溯。*/</span>
</span><span class="line"><span class="n">Inorder</span> <span class="n">Tree</span> <span class="n">Walk</span> <span class="p">(</span><span class="n">Node</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span>
</span><span class="line"><span class="p">{</span>
</span><span class="line">    <span class="n">Node</span> <span class="o">*</span> <span class="n">preprinted</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span><span class="line">    <span class="k">while</span> <span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="n">Node</span> <span class="o">*</span> <span class="n">q</span> <span class="o">=</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
</span><span class="line">        <span class="k">if</span> <span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="k">while</span> <span class="p">(</span><span class="n">q</span> <span class="o">!=</span> <span class="n">preprinted</span> <span class="o">&amp;&amp;</span> <span class="n">q</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">                <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
</span><span class="line">            <span class="p">}</span>
</span><span class="line">            <span class="k">if</span> <span class="p">(</span><span class="n">q</span> <span class="o">!=</span> <span class="n">preprinted</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">                <span class="n">q</span><span class="o">-&gt;</span><span class="n">right</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
</span><span class="line">                <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
</span><span class="line">                <span class="k">continue</span><span class="p">;</span>
</span><span class="line">            <span class="p">}</span>
</span><span class="line">            <span class="k">else</span> <span class="p">{</span>
</span><span class="line">                <span class="n">q</span><span class="o">-&gt;</span><span class="n">right</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span><span class="line">            <span class="p">}</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">);</span>
</span><span class="line">        <span class="n">preprinted</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
</span><span class="line">        <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">-&gt;</span> <span class="n">right</span><span class="p">;</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="section-1">2. 查询二叉查找树</h2>

<h2 id="section-2">3. 插入和删除</h2>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CLRS chapter8 Sorting in Linear Time]]></title>
    <link href="http://iceout.github.com/blog/2012/06/15/clrs-chapter8-sorting-in-linear-time/"/>
    <updated>2012-06-15T16:42:00+08:00</updated>
    <id>http://iceout.github.com/blog/2012/06/15/clrs-chapter8-sorting-in-linear-time</id>
    <content type="html"><![CDATA[<p>之前介绍的排序算法都是属于比较排序算法，他们的时间下界为<script type="math/tex">\Omega(n\lg n)</script>。而一些非比较算法的时间复杂度可以为<script type="math/tex">\Theta(n)</script>。</p>

<h2 id="section">1.排序算法的时间下界</h2>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CLRS第七章快速排序]]></title>
    <link href="http://iceout.github.com/blog/2012/06/13/clrsdi-qi-zhang-kuai-su-pai-xu/"/>
    <updated>2012-06-13T21:32:00+08:00</updated>
    <id>http://iceout.github.com/blog/2012/06/13/clrsdi-qi-zhang-kuai-su-pai-xu</id>
    <content type="html"><![CDATA[<p>虽然快速排序最坏时间复杂度为<script type="math/tex">\Theta(n^2)</script>，但是其平均复杂度为<script type="math/tex">\Theta(n\lg n)</script>，
且常数因子很小，所以快速排序通常是用于排序的最佳实践选择。</p>

<h2 id="section">1.快速排序的描述</h2>
<p>快速排序也是利用了分治的思想，先从数据集合里面选出一个元素作为主元（pivot element），根据主元把数据集分为两个子集，然后对子集进行快速排序。下面是代码描述：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">def</span> <span class="nf">QUICKSORT</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">begin</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
</span><span class="line">    <span class="k">if</span> <span class="n">begin</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">:</span>
</span><span class="line">        <span class="n">mid</span> <span class="o">=</span> <span class="n">PARTITION</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">begin</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</span><span class="line">        <span class="n">QUICKSORT</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">begin</span><span class="p">,</span> <span class="n">mid</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span class="line">        <span class="n">QUICKSORT</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</span><span class="line">
</span><span class="line"><span class="k">def</span> <span class="nf">PARTITION</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">begin</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
</span><span class="line">    <span class="n">x</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">end</span><span class="p">]</span>
</span><span class="line">    <span class="n">j</span> <span class="o">=</span> <span class="n">begin</span>
</span><span class="line">    <span class="n">i</span> <span class="o">=</span> <span class="n">begin</span>
</span><span class="line">    <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">:</span>
</span><span class="line">        <span class="k">if</span> <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">:</span>
</span><span class="line">            <span class="n">exchange</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
</span><span class="line">            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class="line">        <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class="line">    <span class="n">exchange</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">end</span><span class="p">])</span>
</span><span class="line">    <span class="k">return</span> <span class="n">i</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="section-1">2.快速排序的性能</h2>
<p>最坏和最好分别为\(\Theta(n^2)\)和\(\Theta(n\lg n)\)。
考虑平均情况时需要注意到：<strong>平均情况与最佳情况很接近</strong>。</p>

<h2 id="section-2">3.快排的随机化版本</h2>
<p>在算法中加入随机化成分，从而能够获得较好的平均性能。</p>

<p>在PARTITION开头处加入两行代码可以获得RANDOMIZED-PARTITION。</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="n">i</span> <span class="o">=</span> <span class="n">RANDOM</span><span class="p">(</span><span class="n">begin</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</span><span class="line"><span class="n">exchange</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">end</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="section-3">4.快排分析</h2>
<ol>
  <li>最坏情况分析
具体不写了，结论\(\Theta(n^2)\)</li>
  <li>
    <p>期望运行时间
定义随机变量</p>

<script type="math/tex; mode=display">
X_{ij} = I\{z_i与z_j进行比较\};
</script>

    <p>算法总的比较次数（我们不关心执行一次PARTITIOM比较的次数）：</p>

<script type="math/tex; mode=display">
X = \sum_{i=1}^{n-1} \sum_{j=i+1}^{n} X_{ij};
</script>

<script type="math/tex; mode=display">E[X] = \sum_{i=1}^{n-1} \sum_{j=i+1}^{n} Pr\{z_i与z_j进行比较\};</script>

<script type="math/tex; mode=display">Pr\{z_i与z_j进行比较\}=\frac{1}{j-i+1}+\frac{1}{j-i+1}=\frac{2}{j-i+1};</script>

<script type="math/tex; mode=display">% &lt;![CDATA[
E[X]=\sum_{i=1}^{n-1}
\sum_{j=i+1}^{n}\frac{2}{j-i+1}=\sum_{i=1}^{n-1} \sum_{k=1}^{n-i}\frac{2}{k+1}<\sum_{i=1}^{n-1} \sum_{k=1}^{n}\frac{2}{k}=O(n\lg n); %]]&gt;</script>
  </li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CLRS_06_12]]></title>
    <link href="http://iceout.github.com/blog/2012/06/12/clrs-06-12/"/>
    <updated>2012-06-12T00:15:00+08:00</updated>
    <id>http://iceout.github.com/blog/2012/06/12/clrs-06-12</id>
    <content type="html"><![CDATA[<h1 id="section">第三章 函数的增长</h1>

<h2 id="section-1">3.1 渐进记号</h2>
<p>θ</p>

<h2 id="section-2">习题解答：</h2>
<ul>
  <li>3.2-3
 &gt;1. 证明：$$n! = \omeg
 &gt;1. 这这正正证明证明证明证明证明：<script type="math/tex">n! = \omega()</script></li>
</ul>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[践行GTD一周总结]]></title>
    <link href="http://iceout.github.com/blog/2012/06/03/jian-xing-gtd-yi-zhou-zong-jie/"/>
    <updated>2012-06-03T10:30:00+08:00</updated>
    <id>http://iceout.github.com/blog/2012/06/03/jian-xing-gtd-yi-zhou-zong-jie</id>
    <content type="html"><![CDATA[<p>从5月29号开始决定有一次实践GTD,虽然不是最认真的一次,但是到现在为止却也收获颇丰.</p>

<h3 id="section">回顾</h3>
<p>首先简要回顾一下一周的记录情况:</p>

<ul>
  <li>May 29: 计划任务共用时4:11:48,有一些任务没有写在任务列表上.</li>
  <li>May 30: 这一天共用时6:37:57,收集工作比第一天有所进步.</li>
  <li>May 31-Jun 1: 这两天不但没有做好收集工作,而且在以前的不足上没有丝毫改进,一点也没有明确目标.两天分别用时1:59:35和1:45:49.</li>
  <li>Jun 2: 昨天上午睡了过去,下午工作还行,有计划有目标,共用时4:37:02,不过打羽毛球用了3小时…</li>
</ul>

<h3 id="section-1">总结</h3>
<p>然后说一下体会,利用Astrid收集管理任务列表挺不错,虽然同步到日历上有些不足;每天总结时用表格记录时间还是不方便;综上,以后不同步到日历了,利用日历记录每天的时间花费.</p>

<p>另外发现用github page记录笔记挺好的,反正没什么见不得人的,虽然Evernote很不错,但是没有Linux客户端,而且排版让人很不爽,以后可以统一用github记录了,离线查看的问题以后想想办法.</p>

<p>这周的优点:想了半天,好像没有什么优点,I’m on the way算是一个吧.</p>

<p>不足:目前最大的不足是目标不明确,任务定的过于笼统,不清晰,还有就是很多工作没有列在任务清单上,使得效率非常低下,虽然在任务清单上的工作效率也不高,-_-!,还有一点是工作中总是被打断,刚工作一会儿就手痒,想点点网页,这是病,得治!以后除了hacker news,其他都用google reader看.</p>

<h3 id="section-2">结束</h3>
<p>改进措施:</p>

<ol>
  <li>Astrib不在同步到google日历,使用google日历总结每天的时间花费</li>
  <li>全面搜集,制定计划</li>
  <li>使用google reader查看网页</li>
  <li>使用github page记录笔记</li>
</ol>

<p>Winter is coming.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[一个Python的bug]]></title>
    <link href="http://iceout.github.com/blog/2012/06/01/a-bug-of-python/"/>
    <updated>2012-06-01T14:22:00+08:00</updated>
    <id>http://iceout.github.com/blog/2012/06/01/a-bug-of-python</id>
    <content type="html"><![CDATA[<p>昨天阿文同学在写python程序时遇到一个奇怪的错误，经过搜索发现原来是python的一个bug。
python的说明在<a href="http://docs.python.org/c-api/init.html#Py_Finalize">这里</a>,
主要是这句话:</p>

<blockquote>
  <p>The destruction of modules and objects in modules is done in <strong>random order</strong>;
this may cause destructors (__del__() methods) to fail when they depend on
other objects (even functions) or modules.</p>
</blockquote>

<p>由于析构的顺序是随机的，所以会遇到一些意想不到的问题。</p>

<!-- more -->
<p>比如说，这段python代码：
&lt;div class=&#8217;bogus-wrapper&#8217;&gt;<notextile><figure class="code">&lt;figcaption&gt;<span></span>&lt;/figcaption&gt;&lt;div class=&#8221;highlight&#8221;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#8221;gutter&#8221;&gt;&lt;pre class=&#8221;line-numbers&#8221;&gt;<span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#8217;code&#8217;&gt;&lt;pre&gt;<code class="python"><span class="line"><span class="k">class</span> <span class="nc">Person</span><span class="p">:</span>
</span><span class="line">    <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class="line">    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span>
</span><span class="line">        <span class="n">Person</span><span class="o">.</span><span class="n">num</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="n">Person</span><span class="o">.</span><span class="n">num</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">tell</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="k">print</span> <span class="s">&#39;Person name is </span><span class="si">%s</span><span class="s"> and age is </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">age</span><span class="p">)</span>
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">Teacher</span><span class="p">(</span><span class="n">Person</span><span class="p">):</span>
</span><span class="line">    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">salary</span><span class="p">):</span>
</span><span class="line">        <span class="n">Person</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">salary</span> <span class="o">=</span> <span class="n">salary</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="n">Person</span><span class="o">.</span><span class="n">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">tell</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="n">Person</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span class="line">        <span class="k">print</span> <span class="s">&#39;salary is&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">salary</span>
</span><span class="line">
</span><span class="line"><span class="n">t</span> <span class="o">=</span> <span class="n">Teacher</span><span class="p">(</span><span class="s">&#39;evan&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
</span><span class="line"><span class="n">t</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
</span></code>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;</figure></notextile>&lt;/div&gt;
当程序执行完毕，调用__del__析构时，Person的__del__先于t的__del__被调用，所以当调用t的__del__时，就会遇到这个错误：
&gt;Exception AttributeError: “‘NoneType’ object has no attribute ‘__del__’” in 
&lt;bound method Teacher.__del__ of &lt;__main__.Teacher instance at 0xb72cbd0c&gt;&gt; ignored</p>

<p>一个解决方案是不把对象放到module层，即把最后两行代码改为：
&lt;div class=&#8217;bogus-wrapper&#8217;&gt;<notextile><figure class="code">&lt;figcaption&gt;<span></span>&lt;/figcaption&gt;&lt;div class=&#8221;highlight&#8221;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#8221;gutter&#8221;&gt;&lt;pre class=&#8221;line-numbers&#8221;&gt;<span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#8217;code&#8217;&gt;&lt;pre&gt;<code class="python"><span class="line"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span class="line">    <span class="n">t</span> <span class="o">=</span> <span class="n">Teacher</span><span class="p">(</span><span class="s">&#39;evan&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
</span><span class="line">    <span class="n">t</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
</span><span class="line">
</span><span class="line"><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
</span><span class="line">    <span class="n">main</span><span class="p">()</span>
</span></code>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;</figure></notextile>&lt;/div&gt;</p>

<p>参看资料在<a href="https://groups.google.com/d/topic/python-cn/Md9OYHZ4JZk/discussion">这里</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[a program of changing keyboard mapping]]></title>
    <link href="http://iceout.github.com/blog/2012/05/22/a-program-of-changing-keyboard-mapping/"/>
    <updated>2012-05-22T16:48:00+08:00</updated>
    <id>http://iceout.github.com/blog/2012/05/22/a-program-of-changing-keyboard-mapping</id>
    <content type="html"><![CDATA[<h2 id="section">一个修改键盘映射的程序</h2>

<p>以前修改别人的代码而成的键盘映射程序，今天无意中看到了，共享一下。
该程序把1,2,3和4（非小键盘）四个键分别映射成为a,b,c和d.
具体代码见程序的136~191行。只在windows下有效。。。
<!--more --></p>

<h2 id="section-1">程序代码</h2>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
<span class="line-number">49</span>
<span class="line-number">50</span>
<span class="line-number">51</span>
<span class="line-number">52</span>
<span class="line-number">53</span>
<span class="line-number">54</span>
<span class="line-number">55</span>
<span class="line-number">56</span>
<span class="line-number">57</span>
<span class="line-number">58</span>
<span class="line-number">59</span>
<span class="line-number">60</span>
<span class="line-number">61</span>
<span class="line-number">62</span>
<span class="line-number">63</span>
<span class="line-number">64</span>
<span class="line-number">65</span>
<span class="line-number">66</span>
<span class="line-number">67</span>
<span class="line-number">68</span>
<span class="line-number">69</span>
<span class="line-number">70</span>
<span class="line-number">71</span>
<span class="line-number">72</span>
<span class="line-number">73</span>
<span class="line-number">74</span>
<span class="line-number">75</span>
<span class="line-number">76</span>
<span class="line-number">77</span>
<span class="line-number">78</span>
<span class="line-number">79</span>
<span class="line-number">80</span>
<span class="line-number">81</span>
<span class="line-number">82</span>
<span class="line-number">83</span>
<span class="line-number">84</span>
<span class="line-number">85</span>
<span class="line-number">86</span>
<span class="line-number">87</span>
<span class="line-number">88</span>
<span class="line-number">89</span>
<span class="line-number">90</span>
<span class="line-number">91</span>
<span class="line-number">92</span>
<span class="line-number">93</span>
<span class="line-number">94</span>
<span class="line-number">95</span>
<span class="line-number">96</span>
<span class="line-number">97</span>
<span class="line-number">98</span>
<span class="line-number">99</span>
<span class="line-number">100</span>
<span class="line-number">101</span>
<span class="line-number">102</span>
<span class="line-number">103</span>
<span class="line-number">104</span>
<span class="line-number">105</span>
<span class="line-number">106</span>
<span class="line-number">107</span>
<span class="line-number">108</span>
<span class="line-number">109</span>
<span class="line-number">110</span>
<span class="line-number">111</span>
<span class="line-number">112</span>
<span class="line-number">113</span>
<span class="line-number">114</span>
<span class="line-number">115</span>
<span class="line-number">116</span>
<span class="line-number">117</span>
<span class="line-number">118</span>
<span class="line-number">119</span>
<span class="line-number">120</span>
<span class="line-number">121</span>
<span class="line-number">122</span>
<span class="line-number">123</span>
<span class="line-number">124</span>
<span class="line-number">125</span>
<span class="line-number">126</span>
<span class="line-number">127</span>
<span class="line-number">128</span>
<span class="line-number">129</span>
<span class="line-number">130</span>
<span class="line-number">131</span>
<span class="line-number">132</span>
<span class="line-number">133</span>
<span class="line-number">134</span>
<span class="line-number">135</span>
<span class="line-number">136</span>
<span class="line-number">137</span>
<span class="line-number">138</span>
<span class="line-number">139</span>
<span class="line-number">140</span>
<span class="line-number">141</span>
<span class="line-number">142</span>
<span class="line-number">143</span>
<span class="line-number">144</span>
<span class="line-number">145</span>
<span class="line-number">146</span>
<span class="line-number">147</span>
<span class="line-number">148</span>
<span class="line-number">149</span>
<span class="line-number">150</span>
<span class="line-number">151</span>
<span class="line-number">152</span>
<span class="line-number">153</span>
<span class="line-number">154</span>
<span class="line-number">155</span>
<span class="line-number">156</span>
<span class="line-number">157</span>
<span class="line-number">158</span>
<span class="line-number">159</span>
<span class="line-number">160</span>
<span class="line-number">161</span>
<span class="line-number">162</span>
<span class="line-number">163</span>
<span class="line-number">164</span>
<span class="line-number">165</span>
<span class="line-number">166</span>
<span class="line-number">167</span>
<span class="line-number">168</span>
<span class="line-number">169</span>
<span class="line-number">170</span>
<span class="line-number">171</span>
<span class="line-number">172</span>
<span class="line-number">173</span>
<span class="line-number">174</span>
<span class="line-number">175</span>
<span class="line-number">176</span>
<span class="line-number">177</span>
<span class="line-number">178</span>
<span class="line-number">179</span>
<span class="line-number">180</span>
<span class="line-number">181</span>
<span class="line-number">182</span>
<span class="line-number">183</span>
<span class="line-number">184</span>
<span class="line-number">185</span>
<span class="line-number">186</span>
<span class="line-number">187</span>
<span class="line-number">188</span>
<span class="line-number">189</span>
<span class="line-number">190</span>
<span class="line-number">191</span>
<span class="line-number">192</span>
<span class="line-number">193</span>
<span class="line-number">194</span>
<span class="line-number">195</span>
<span class="line-number">196</span>
</pre></td><td class="code"><pre><code class="c++"><span class="line"><span class="cm">/*</span>
</span><span class="line"><span class="cm">	PROJECT:</span>
</span><span class="line"><span class="cm">		Keymapper v1.1</span>
</span><span class="line">
</span><span class="line"><span class="cm">	DESCRIPTION:</span>
</span><span class="line"><span class="cm">		Keymapper is a portable tool to remap Caps Lock to Backspace without rebooting.</span>
</span><span class="line"><span class="cm">		Intended for Colemak enthusiasts roaming on others&#39; QWERTY keyboard layouts.</span>
</span><span class="line">
</span><span class="line"><span class="cm">		Caps Lock keypresses are intercepted with a global keyboard hook (SetWindowsHookEx)</span>
</span><span class="line"><span class="cm">		and a backspace keypress is simulated in its place to improve touch typing (keybd_event).</span>
</span><span class="line">
</span><span class="line"><span class="cm">		Certain anti-virus heuristics may classify the executable as a potential threat</span>
</span><span class="line"><span class="cm">		due to the keylogging potential of a global keyboard hook. The right way to remap</span>
</span><span class="line"><span class="cm">		your keyboard is using a registry tool like SharpKeys.</span>
</span><span class="line">
</span><span class="line"><span class="cm">	LICENCE:</span>
</span><span class="line"><span class="cm">		Copyright 2010 FreshCode (www.freshcode.co.za).</span>
</span><span class="line">
</span><span class="line"><span class="cm">		Redistribution and use in source and binary forms, with or without modification, are</span>
</span><span class="line"><span class="cm">		permitted provided that the following conditions are met:</span>
</span><span class="line">
</span><span class="line"><span class="cm">			1. Redistributions of source code must retain the above copyright notice, this</span>
</span><span class="line"><span class="cm">			list of conditions and the following disclaimer.</span>
</span><span class="line">
</span><span class="line"><span class="cm">			2. Redistributions in binary form must reproduce the above copyright notice, this</span>
</span><span class="line"><span class="cm">			list of conditions and the following disclaimer in the documentation and/or other</span>
</span><span class="line"><span class="cm">			materials provided with the distribution.</span>
</span><span class="line">
</span><span class="line"><span class="cm">		This software is provided by FreshCode ``as is&#39;&#39; without any express or implied warranty</span>
</span><span class="line"><span class="cm">		blah blah blah if you break stuff, you&#39;re an idiot.</span>
</span><span class="line"><span class="cm">*/</span>
</span><span class="line">
</span><span class="line"><span class="cp">// Make a really small executable</span>
</span><span class="line"><span class="cp">#pragma comment(linker,&quot;/ENTRY:main&quot;) </span><span class="c1">// Set entry point</span>
</span><span class="line">
</span><span class="line"><span class="cp">// Merge all default sections into the .text (code) section.</span>
</span><span class="line"><span class="cp">#pragma comment(linker,&quot;/MERGE:.rdata=.data&quot;)</span>
</span><span class="line"><span class="cp">#pragma comment(linker,&quot;/MERGE:.text=.data&quot;)</span>
</span><span class="line">
</span><span class="line"><span class="cp">#pragma comment(lib, &quot;msvcrt.lib&quot;)</span>
</span><span class="line">
</span><span class="line"><span class="cp">#if (_MSC_VER &lt; 1300)</span>
</span><span class="line"><span class="cp">	#pragma comment(linker,&quot;/IGNORE:4078&quot;)</span>
</span><span class="line"><span class="cp">	#pragma comment(linker,&quot;/OPT:NOWIN98&quot;)</span>
</span><span class="line"><span class="cp">#endif</span>
</span><span class="line">
</span><span class="line"><span class="cp">#pragma comment(linker, &quot;/FILEALIGN:0x200&quot;)</span>
</span><span class="line">
</span><span class="line"><span class="cp">#define WIN32_LEAN_AND_MEAN</span>
</span><span class="line"><span class="cp">#define VC_EXTRALEAN</span>
</span><span class="line">
</span><span class="line"><span class="cp">#include &lt;windows.h&gt;</span>
</span><span class="line">
</span><span class="line"><span class="n">LRESULT</span> <span class="n">CALLBACK</span> <span class="n">LowLevelKeyboardProc</span><span class="p">(</span><span class="kt">int</span> <span class="n">nCode</span><span class="p">,</span> <span class="n">WPARAM</span> <span class="n">wParam</span><span class="p">,</span> <span class="n">LPARAM</span> <span class="n">lParam</span><span class="p">);</span>
</span><span class="line"><span class="n">BOOL</span> <span class="n">WINAPI</span> <span class="n">ConsoleEventHandler</span><span class="p">(</span><span class="n">DWORD</span> <span class="n">dwCtrlType</span><span class="p">);</span> <span class="c1">// for graceful exit</span>
</span><span class="line"><span class="n">DWORD</span> <span class="n">dwMainThread</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// because apparently the console event handler thread for Ctrl+C is different from the main thread</span>
</span><span class="line">
</span><span class="line"><span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
</span><span class="line"><span class="p">{</span>
</span><span class="line">	<span class="k">const</span> <span class="kt">char</span> <span class="n">message</span><span class="p">[]</span> <span class="o">=</span>
</span><span class="line">		<span class="s">&quot;Caps Lock Remapper</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span class="line">		<span class="s">&quot;Remaps Caps Lock to Backspace on the fly without rebooting.</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span class="line">		<span class="s">&quot;Copyright 2010 FreshCode (www.freshcode.co.za)</span><span class="se">\n</span><span class="s">&quot;</span>
</span><span class="line">		<span class="s">&quot;</span><span class="se">\n</span><span class="s">Press Ctrl+C or close window to exit.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span class="line">
</span><span class="line">	<span class="n">DWORD</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">	<span class="n">HANDLE</span> <span class="n">hStdOut</span> <span class="o">=</span> <span class="n">GetStdHandle</span><span class="p">(</span><span class="n">STD_OUTPUT_HANDLE</span><span class="p">);</span>
</span><span class="line">	<span class="n">WriteConsoleA</span><span class="p">(</span><span class="n">hStdOut</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">message</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">count</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
</span><span class="line">
</span><span class="line">	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SetConsoleCtrlHandler</span><span class="p">(</span><span class="n">ConsoleEventHandler</span><span class="p">,</span> <span class="n">TRUE</span><span class="p">))</span>
</span><span class="line">	<span class="p">{</span>
</span><span class="line">		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span><span class="line">	<span class="p">}</span> <span class="k">else</span>
</span><span class="line">	<span class="p">{</span>
</span><span class="line">		<span class="n">dwMainThread</span> <span class="o">=</span> <span class="n">GetCurrentThreadId</span><span class="p">();</span>
</span><span class="line">	<span class="p">}</span>
</span><span class="line">
</span><span class="line">	<span class="c1">// Retrieve the applications instance</span>
</span><span class="line">	<span class="n">HINSTANCE</span> <span class="n">appInstance</span> <span class="o">=</span> <span class="n">GetModuleHandle</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
</span><span class="line">
</span><span class="line">	<span class="c1">// Attach global keyboard hook to capture keystrokes</span>
</span><span class="line">	<span class="n">HHOOK</span> <span class="n">hHook</span> <span class="o">=</span> <span class="n">SetWindowsHookEx</span><span class="p">(</span><span class="n">WH_KEYBOARD_LL</span><span class="p">,</span> <span class="n">LowLevelKeyboardProc</span><span class="p">,</span> <span class="n">appInstance</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class="line">	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">hHook</span><span class="p">)</span>
</span><span class="line">		<span class="k">return</span> <span class="o">-</span><span class="mi">2</span><span class="p">;</span>
</span><span class="line">
</span><span class="line">	<span class="n">MSG</span> <span class="n">msg</span><span class="p">;</span>
</span><span class="line">
</span><span class="line">	<span class="k">while</span><span class="p">(</span><span class="n">GetMessage</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span class="line">	<span class="p">{</span>
</span><span class="line">		<span class="n">TranslateMessage</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
</span><span class="line">		<span class="n">DispatchMessage</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
</span><span class="line">	<span class="p">}</span>
</span><span class="line">
</span><span class="line">	<span class="c1">// Clean up</span>
</span><span class="line">	<span class="n">UnhookWindowsHookEx</span><span class="p">(</span><span class="n">hHook</span><span class="p">);</span>
</span><span class="line">	<span class="n">SetConsoleCtrlHandler</span><span class="p">(</span><span class="n">ConsoleEventHandler</span><span class="p">,</span> <span class="n">FALSE</span><span class="p">);</span>
</span><span class="line">
</span><span class="line">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="n">LRESULT</span> <span class="n">CALLBACK</span> <span class="n">LowLevelKeyboardProc</span><span class="p">(</span><span class="kt">int</span> <span class="n">nCode</span><span class="p">,</span> <span class="n">WPARAM</span> <span class="n">wParam</span><span class="p">,</span> <span class="n">LPARAM</span> <span class="n">lParam</span><span class="p">)</span>
</span><span class="line"><span class="p">{</span>
</span><span class="line">	<span class="n">KBDLLHOOKSTRUCT</span> <span class="o">*</span><span class="n">pKeyBoard</span> <span class="o">=</span> <span class="p">(</span><span class="n">KBDLLHOOKSTRUCT</span> <span class="o">*</span><span class="p">)</span><span class="n">lParam</span><span class="p">;</span>
</span><span class="line">
</span><span class="line">	<span class="k">switch</span><span class="p">(</span> <span class="n">pKeyBoard</span><span class="o">-&gt;</span><span class="n">vkCode</span> <span class="p">)</span>
</span><span class="line">	<span class="p">{</span>
</span><span class="line"><span class="cm">/*        case VK_CAPITAL:</span>
</span><span class="line"><span class="cm">            {</span>
</span><span class="line"><span class="cm">                switch (wParam)</span>
</span><span class="line"><span class="cm">                {</span>
</span><span class="line"><span class="cm">                case WM_KEYDOWN:</span>
</span><span class="line"><span class="cm">                    keybd_event(VK_BACK, 0x8e, 0, 0);</span>
</span><span class="line"><span class="cm">                    return 1;</span>
</span><span class="line"><span class="cm">                case WM_KEYUP:</span>
</span><span class="line"><span class="cm">                    keybd_event(VK_BACK, 0x8e, KEYEVENTF_KEYUP, 0);</span>
</span><span class="line"><span class="cm">                    return 1;</span>
</span><span class="line"><span class="cm">                }</span>
</span><span class="line"><span class="cm">            }</span>
</span><span class="line"><span class="cm">            break;*/</span>
</span><span class="line">            <span class="c1">//0x31 == 1;0x41 == a;</span>
</span><span class="line">        <span class="k">case</span> <span class="mh">0x31</span><span class="o">:</span>
</span><span class="line">            <span class="p">{</span>
</span><span class="line">                <span class="k">switch</span> <span class="p">(</span><span class="n">wParam</span><span class="p">)</span>
</span><span class="line">                <span class="p">{</span>
</span><span class="line">                <span class="k">case</span> <span class="nl">WM_KEYDOWN:</span>
</span><span class="line">                    <span class="n">keybd_event</span><span class="p">(</span><span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class="line">                    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span><span class="line">                <span class="k">case</span> <span class="nl">WM_KEYUP:</span>
</span><span class="line">                    <span class="n">keybd_event</span><span class="p">(</span><span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="n">KEYEVENTF_KEYUP</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class="line">                    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span><span class="line">                <span class="p">}</span>
</span><span class="line">            <span class="p">}</span>
</span><span class="line">            <span class="k">break</span><span class="p">;</span>
</span><span class="line">            <span class="c1">//0x32 == 2;0x42 == b;</span>
</span><span class="line">        <span class="k">case</span> <span class="mh">0x32</span><span class="o">:</span>
</span><span class="line">            <span class="p">{</span>
</span><span class="line">                <span class="k">switch</span> <span class="p">(</span><span class="n">wParam</span><span class="p">)</span>
</span><span class="line">                <span class="p">{</span>
</span><span class="line">                <span class="k">case</span> <span class="nl">WM_KEYDOWN:</span>
</span><span class="line">                    <span class="n">keybd_event</span><span class="p">(</span><span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class="line">                    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span><span class="line">                <span class="k">case</span> <span class="nl">WM_KEYUP:</span>
</span><span class="line">                    <span class="n">keybd_event</span><span class="p">(</span><span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="n">KEYEVENTF_KEYUP</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class="line">                    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span><span class="line">                <span class="p">}</span>
</span><span class="line">            <span class="p">}</span>
</span><span class="line">            <span class="k">break</span><span class="p">;</span>
</span><span class="line">            <span class="c1">//0x33 == 3;0x43 == c;</span>
</span><span class="line">        <span class="k">case</span> <span class="mh">0x33</span><span class="o">:</span>
</span><span class="line">            <span class="p">{</span>
</span><span class="line">                <span class="k">switch</span> <span class="p">(</span><span class="n">wParam</span><span class="p">)</span>
</span><span class="line">                <span class="p">{</span>
</span><span class="line">                <span class="k">case</span> <span class="nl">WM_KEYDOWN:</span>
</span><span class="line">                    <span class="n">keybd_event</span><span class="p">(</span><span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class="line">                    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span><span class="line">                <span class="k">case</span> <span class="nl">WM_KEYUP:</span>
</span><span class="line">                    <span class="n">keybd_event</span><span class="p">(</span><span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="n">KEYEVENTF_KEYUP</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class="line">                    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span><span class="line">                <span class="p">}</span>
</span><span class="line">            <span class="p">}</span>
</span><span class="line">            <span class="k">break</span><span class="p">;</span>
</span><span class="line">            <span class="c1">//0x34 == 4;0x44 == d;</span>
</span><span class="line">        <span class="k">case</span> <span class="mh">0x34</span><span class="o">:</span>
</span><span class="line">            <span class="p">{</span>
</span><span class="line">                <span class="k">switch</span> <span class="p">(</span><span class="n">wParam</span><span class="p">)</span>
</span><span class="line">                <span class="p">{</span>
</span><span class="line">                <span class="k">case</span> <span class="nl">WM_KEYDOWN:</span>
</span><span class="line">                    <span class="n">keybd_event</span><span class="p">(</span><span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class="line">                    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span><span class="line">                <span class="k">case</span> <span class="nl">WM_KEYUP:</span>
</span><span class="line">                    <span class="n">keybd_event</span><span class="p">(</span><span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="n">KEYEVENTF_KEYUP</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class="line">                    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span><span class="line">                <span class="p">}</span>
</span><span class="line">            <span class="p">}</span>
</span><span class="line">            <span class="k">break</span><span class="p">;</span>
</span><span class="line">		<span class="k">default</span><span class="o">:</span>
</span><span class="line">			<span class="k">return</span> <span class="n">CallNextHookEx</span><span class="p">(</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">nCode</span><span class="p">,</span> <span class="n">wParam</span><span class="p">,</span> <span class="n">lParam</span> <span class="p">);</span>
</span><span class="line">	<span class="p">}</span>
</span><span class="line">
</span><span class="line">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="n">BOOL</span> <span class="n">WINAPI</span> <span class="n">ConsoleEventHandler</span><span class="p">(</span><span class="n">DWORD</span> <span class="n">dwCtrlType</span><span class="p">)</span>
</span><span class="line"><span class="p">{</span>
</span><span class="line">    <span class="k">switch</span><span class="p">(</span><span class="n">dwCtrlType</span><span class="p">)</span>
</span><span class="line">    <span class="p">{</span>
</span><span class="line">        <span class="k">case</span> <span class="nl">CTRL_C_EVENT:</span>
</span><span class="line">		<span class="k">case</span> <span class="nl">CTRL_CLOSE_EVENT:</span>
</span><span class="line">			<span class="n">PostThreadMessage</span><span class="p">(</span><span class="n">dwMainThread</span><span class="p">,</span> <span class="n">WM_QUIT</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
</span><span class="line">			<span class="k">return</span> <span class="n">TRUE</span><span class="p">;</span>
</span><span class="line">
</span><span class="line">        <span class="k">default</span><span class="o">:</span>
</span><span class="line">            <span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[poj 1035:Spell checker]]></title>
    <link href="http://iceout.github.com/blog/2012/05/07/poj-1035/"/>
    <updated>2012-05-07T12:36:00+08:00</updated>
    <id>http://iceout.github.com/blog/2012/05/07/poj-1035</id>
    <content type="html"><![CDATA[<h2 id="section">题目说明</h2>
<p><a href="http://poj.org/problem?id=1035">原题在这里。</a></p>

<p>很简单的一道题，输入分为两部分，首先是一个字典,最多包含10000个词语。以一个“#”作为字典的结束。
剩余部分为需要检查的词语，也是以“#”结束。</p>

<p>所有的词语都是由小写字母组成，最多包含15个字母。每个词占语一行。
如果所检查的词语正确则输出“is correct”，否则则根据三条规则输出相近的词语。三条规则如下：</p>

<ul>
  <li>leting of one letter from the word;</li>
  <li>replacing of one letter in the word with an arbitrary letter;</li>
  <li>inserting of one arbitrary letter into the word. </li>
</ul>

<!--more-->

<h2 id="section-1">程序代码</h2>
<p>我的初步解法内存消耗360K，时间235MS。代码在<a href="https://github.com/iceout/poj/blob/a76987067dc373785e245cf990e8258ea21c2984/poj1035.c">这里</a>，其实结构还算清晰，就是效率不高，-_-，待优化。</p>

<p><em>update：</em>
进行了一些优化，首先进行排序，然后通过二分法查找是否为正确的词语，是的话输出，否则就查找相近的词语。
内存增加到了440K，时间缩短为125MS。不知道那些60、70MS怎么优化的。。。</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>poj1035:spell checker </span><a href="https://github.com/iceout/poj/blob/master/poj1035.c">link</a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
<span class="line-number">49</span>
<span class="line-number">50</span>
<span class="line-number">51</span>
<span class="line-number">52</span>
<span class="line-number">53</span>
<span class="line-number">54</span>
<span class="line-number">55</span>
<span class="line-number">56</span>
<span class="line-number">57</span>
<span class="line-number">58</span>
<span class="line-number">59</span>
<span class="line-number">60</span>
<span class="line-number">61</span>
<span class="line-number">62</span>
<span class="line-number">63</span>
<span class="line-number">64</span>
<span class="line-number">65</span>
<span class="line-number">66</span>
<span class="line-number">67</span>
<span class="line-number">68</span>
<span class="line-number">69</span>
<span class="line-number">70</span>
<span class="line-number">71</span>
<span class="line-number">72</span>
<span class="line-number">73</span>
<span class="line-number">74</span>
<span class="line-number">75</span>
<span class="line-number">76</span>
<span class="line-number">77</span>
<span class="line-number">78</span>
<span class="line-number">79</span>
<span class="line-number">80</span>
<span class="line-number">81</span>
<span class="line-number">82</span>
<span class="line-number">83</span>
<span class="line-number">84</span>
<span class="line-number">85</span>
<span class="line-number">86</span>
<span class="line-number">87</span>
<span class="line-number">88</span>
<span class="line-number">89</span>
<span class="line-number">90</span>
<span class="line-number">91</span>
<span class="line-number">92</span>
<span class="line-number">93</span>
<span class="line-number">94</span>
<span class="line-number">95</span>
<span class="line-number">96</span>
<span class="line-number">97</span>
<span class="line-number">98</span>
<span class="line-number">99</span>
<span class="line-number">100</span>
<span class="line-number">101</span>
<span class="line-number">102</span>
<span class="line-number">103</span>
<span class="line-number">104</span>
<span class="line-number">105</span>
<span class="line-number">106</span>
<span class="line-number">107</span>
<span class="line-number">108</span>
<span class="line-number">109</span>
<span class="line-number">110</span>
<span class="line-number">111</span>
<span class="line-number">112</span>
<span class="line-number">113</span>
<span class="line-number">114</span>
<span class="line-number">115</span>
<span class="line-number">116</span>
<span class="line-number">117</span>
<span class="line-number">118</span>
<span class="line-number">119</span>
<span class="line-number">120</span>
<span class="line-number">121</span>
<span class="line-number">122</span>
<span class="line-number">123</span>
<span class="line-number">124</span>
<span class="line-number">125</span>
<span class="line-number">126</span>
<span class="line-number">127</span>
<span class="line-number">128</span>
<span class="line-number">129</span>
<span class="line-number">130</span>
<span class="line-number">131</span>
<span class="line-number">132</span>
<span class="line-number">133</span>
<span class="line-number">134</span>
<span class="line-number">135</span>
<span class="line-number">136</span>
<span class="line-number">137</span>
<span class="line-number">138</span>
<span class="line-number">139</span>
<span class="line-number">140</span>
<span class="line-number">141</span>
<span class="line-number">142</span>
<span class="line-number">143</span>
<span class="line-number">144</span>
<span class="line-number">145</span>
<span class="line-number">146</span>
<span class="line-number">147</span>
<span class="line-number">148</span>
<span class="line-number">149</span>
<span class="line-number">150</span>
<span class="line-number">151</span>
<span class="line-number">152</span>
<span class="line-number">153</span>
<span class="line-number">154</span>
<span class="line-number">155</span>
<span class="line-number">156</span>
<span class="line-number">157</span>
<span class="line-number">158</span>
</pre></td><td class="code"><pre><code class="c++"><span class="line"><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class="line"><span class="cp">#include &lt;string.h&gt;</span>
</span><span class="line"><span class="cp">#include &lt;stdlib.h&gt;</span>
</span><span class="line">
</span><span class="line"><span class="kt">char</span> <span class="n">dic</span><span class="p">[</span><span class="mi">10000</span><span class="p">][</span><span class="mi">16</span><span class="p">];</span>
</span><span class="line"><span class="kt">int</span> <span class="n">sorted</span><span class="p">[</span><span class="mi">10000</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span>
</span><span class="line">
</span><span class="line"><span class="kt">int</span> <span class="n">check</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">small</span><span class="p">);</span>
</span><span class="line">
</span><span class="line"><span class="kt">int</span> <span class="n">ncom</span><span class="p">(</span><span class="k">const</span> <span class="kt">void</span> <span class="o">*</span> <span class="n">p</span><span class="p">,</span> <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
</span><span class="line"><span class="p">{</span>
</span><span class="line">    <span class="k">return</span> <span class="o">*</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">p</span> <span class="o">-</span> <span class="o">*</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">q</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="kt">int</span> <span class="n">comp</span><span class="p">(</span><span class="k">const</span> <span class="kt">void</span> <span class="o">*</span> <span class="n">p</span><span class="p">,</span> <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
</span><span class="line"><span class="p">{</span>
</span><span class="line">    <span class="k">if</span> <span class="p">(((</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">p</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="p">((</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">q</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
</span><span class="line">        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">    <span class="k">else</span> <span class="k">if</span> <span class="p">(((</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">p</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="p">((</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">q</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
</span><span class="line">        <span class="k">return</span> <span class="n">strcmp</span><span class="p">(</span><span class="n">dic</span><span class="p">[((</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">p</span><span class="p">)[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">dic</span><span class="p">[((</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">q</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]);</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">    <span class="k">else</span> <span class="p">{</span>
</span><span class="line">        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">argv</span><span class="p">[])</span>
</span><span class="line"><span class="p">{</span>
</span><span class="line">    <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
</span><span class="line">    <span class="kt">int</span> <span class="n">numdic</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">
</span><span class="line">    <span class="kt">char</span> <span class="n">word</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
</span><span class="line">    <span class="kt">int</span> <span class="n">lenword</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">    <span class="kt">int</span> <span class="n">replace</span><span class="p">[</span><span class="mi">10000</span><span class="p">];</span>
</span><span class="line">    <span class="kt">int</span> <span class="n">t</span><span class="p">;</span>
</span><span class="line">    <span class="kt">int</span> <span class="n">count</span><span class="p">;</span>
</span><span class="line">    <span class="kt">int</span> <span class="n">first</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">last</span><span class="p">;</span>
</span><span class="line">
</span><span class="line">    <span class="cm">/*Read the dict*/</span>
</span><span class="line">    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span> <span class="n">dic</span><span class="p">[</span><span class="n">numdic</span><span class="p">]);</span>
</span><span class="line">        <span class="k">if</span> <span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">numdic</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;#&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="k">break</span><span class="p">;</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">        <span class="n">replace</span><span class="p">[</span><span class="n">numdic</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">        <span class="n">sorted</span><span class="p">[</span><span class="n">numdic</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">numdic</span><span class="p">;</span>
</span><span class="line">        <span class="n">sorted</span><span class="p">[</span><span class="n">numdic</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">numdic</span><span class="p">]);</span>
</span><span class="line">        <span class="n">numdic</span><span class="o">++</span><span class="p">;</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">
</span><span class="line">    <span class="n">qsort</span><span class="p">(</span><span class="n">sorted</span><span class="p">,</span> <span class="n">numdic</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">comp</span><span class="p">);</span>
</span><span class="line">
</span><span class="line">    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span> <span class="n">word</span><span class="p">);</span>
</span><span class="line">        <span class="k">if</span> <span class="p">(</span><span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;#&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="k">break</span><span class="p">;</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span> <span class="n">word</span><span class="p">);</span>
</span><span class="line">        <span class="n">lenword</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">word</span><span class="p">);</span>
</span><span class="line">        <span class="n">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span><span class="line">        <span class="k">while</span> <span class="p">(</span><span class="o">++</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">numdic</span> <span class="o">&amp;&amp;</span> <span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lenword</span><span class="p">);</span>
</span><span class="line">
</span><span class="line">        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">numdic</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="n">first</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span><span class="line">            <span class="n">i</span><span class="o">--</span><span class="p">;</span>
</span><span class="line">            <span class="k">while</span> <span class="p">(</span><span class="o">++</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">numdic</span> <span class="o">&amp;&amp;</span> <span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">lenword</span><span class="p">);</span>
</span><span class="line">            <span class="n">last</span> <span class="o">=</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span><span class="line">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">last</span> <span class="o">-</span> <span class="n">first</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
</span><span class="line">            <span class="n">j</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span><span class="line">            <span class="k">while</span> <span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">                <span class="k">if</span> <span class="p">(</span><span class="n">last</span> <span class="o">&lt;</span> <span class="n">first</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">                    <span class="k">break</span><span class="p">;</span>
</span><span class="line">                <span class="p">}</span>
</span><span class="line">                <span class="n">mid</span> <span class="o">=</span> <span class="n">first</span> <span class="o">+</span> <span class="p">(</span><span class="n">last</span> <span class="o">-</span> <span class="n">first</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
</span><span class="line">                <span class="n">j</span> <span class="o">=</span> <span class="n">strcmp</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">sorted</span><span class="p">[</span><span class="n">mid</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="n">word</span><span class="p">);</span>
</span><span class="line">                <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">                    <span class="n">printf</span><span class="p">(</span><span class="s">&quot; is correct</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class="line">                    <span class="k">break</span><span class="p">;</span>
</span><span class="line">                <span class="p">}</span>
</span><span class="line">                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">                    <span class="n">first</span> <span class="o">=</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
</span><span class="line">                <span class="p">}</span>
</span><span class="line">                <span class="k">else</span> <span class="p">{</span>
</span><span class="line">                    <span class="n">last</span> <span class="o">=</span> <span class="n">mid</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span><span class="line">                <span class="p">}</span>
</span><span class="line">            <span class="p">}</span>
</span><span class="line">            <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">                <span class="k">continue</span><span class="p">;</span>
</span><span class="line">            <span class="p">}</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">        <span class="n">count</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span><span class="line">        <span class="n">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span><span class="line">        <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">        <span class="k">while</span> <span class="p">(</span><span class="o">++</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">numdic</span> <span class="o">&amp;&amp;</span> <span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lenword</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span><span class="line">        <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">numdic</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="k">if</span> <span class="p">(</span><span class="n">lenword</span><span class="o">-</span><span class="mi">1</span> <span class="o">==</span> <span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
</span><span class="line">                <span class="k">if</span> <span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="n">word</span><span class="p">,</span> <span class="n">lenword</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">                    <span class="n">replace</span><span class="p">[</span><span class="n">t</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
</span><span class="line">                <span class="p">}</span>
</span><span class="line">            <span class="p">}</span>
</span><span class="line">            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">lenword</span> <span class="o">==</span> <span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
</span><span class="line">                <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">                <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">lenword</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">                    <span class="k">if</span> <span class="p">(</span><span class="n">word</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="n">dic</span><span class="p">[</span><span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">j</span><span class="p">])</span> <span class="p">{</span>
</span><span class="line">                        <span class="n">count</span><span class="o">++</span><span class="p">;</span>
</span><span class="line">                    <span class="p">}</span>
</span><span class="line">                <span class="p">}</span>
</span><span class="line">                <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">){</span>
</span><span class="line">                    <span class="n">replace</span><span class="p">[</span><span class="n">t</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
</span><span class="line">                <span class="p">}</span>
</span><span class="line">            <span class="p">}</span>
</span><span class="line">            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">lenword</span><span class="o">+</span><span class="mi">1</span> <span class="o">==</span> <span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
</span><span class="line">                <span class="k">if</span> <span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">dic</span><span class="p">[</span><span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="n">lenword</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">                    <span class="n">replace</span><span class="p">[</span><span class="n">t</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
</span><span class="line">                <span class="p">}</span>
</span><span class="line">            <span class="p">}</span>
</span><span class="line">            <span class="k">else</span> <span class="p">{</span>
</span><span class="line">                <span class="k">break</span><span class="p">;</span>
</span><span class="line">            <span class="p">}</span>
</span><span class="line">            <span class="n">i</span><span class="o">++</span><span class="p">;</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">        <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="n">qsort</span><span class="p">(</span><span class="n">replace</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span> <span class="n">ncom</span><span class="p">);</span>
</span><span class="line">            <span class="n">printf</span><span class="p">(</span><span class="s">&quot;:&quot;</span><span class="p">);</span>
</span><span class="line">            <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">            <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="n">t</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">                <span class="n">printf</span><span class="p">(</span><span class="s">&quot; %s&quot;</span><span class="p">,</span> <span class="n">dic</span><span class="p">[</span><span class="n">replace</span><span class="p">[</span><span class="n">j</span><span class="o">++</span><span class="p">]]);</span>
</span><span class="line">            <span class="p">}</span>
</span><span class="line">            <span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="kt">int</span> <span class="n">check</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">small</span><span class="p">)</span>
</span><span class="line"><span class="p">{</span>
</span><span class="line">    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">
</span><span class="line">    <span class="k">while</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="p">{</span>
</span><span class="line">        <span class="n">i</span><span class="o">++</span><span class="p">;</span>
</span><span class="line">        <span class="n">j</span><span class="o">++</span><span class="p">;</span>
</span><span class="line">        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="n">small</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">    <span class="n">j</span><span class="o">++</span><span class="p">;</span>
</span><span class="line">    <span class="k">while</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="p">{</span>
</span><span class="line">        <span class="n">i</span><span class="o">++</span><span class="p">;</span>
</span><span class="line">        <span class="n">j</span><span class="o">++</span><span class="p">;</span>
</span><span class="line">        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="n">small</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">
</span><span class="line">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Hello World]]></title>
    <link href="http://iceout.github.com/blog/2012/04/21/hello-world/"/>
    <updated>2012-04-21T01:31:00+08:00</updated>
    <id>http://iceout.github.com/blog/2012/04/21/hello-world</id>
    <content type="html"><![CDATA[<h1 id="h1">h1</h1>

<h2 id="h2">h2</h2>

<h3 id="h3">h3</h3>

<h2 id="latex">Latex</h2>

<p><code>$$E = mc^2$$</code>的结果<script type="math/tex">E = mc^2</script></p>

<p><code>\\(E=mc^2\\)</code>的结果\(E=mc^2\)</p>

<h2 id="section">图片</h2>
<p><img src="http://iceout.github.com/uploads/Screenshot2.png" alt="octopress" title="God bless me!" />
<img class="center" src="http://iceout.github.com/uploads/Screenshot2.png" title="world peace #2" />
left center right, center does not work.</p>

<h2 id="c">C</h2>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>hello </span><a href="http://iceout.github.com/blog/2012/04/21/hello-world/">link</a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="c++"><span class="line"><span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">argv</span><span class="p">[])</span>
</span><span class="line"><span class="p">{</span>
</span><span class="line">    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello, World!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class="line">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="python">Python</h2>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="k">print</span> <span class="s">&#39;Hello, World!&#39;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="java">Java</h2>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="java"><span class="line"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span><span class="line">	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Hello, World!&quot;</span><span class="o">);</span>
</span><span class="line"><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
]]></content>
  </entry>
  
</feed>
